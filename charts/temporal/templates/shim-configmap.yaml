apiVersion: v1
kind: ConfigMap
metadata:
  name: "{{ include "temporal.fullname" $ }}-shims"
  labels:
    {{- include "temporal.resourceLabels" (list $ "" "") | nindent 4 }}
data:
  dockerize: |-
    #!/bin/sh
    set -e

    # Parse command line arguments
    while [ $# -gt 0 ]; do
        case "$1" in
            -template)
                shift
                TEMPLATE="$1"
                shift
                ;;
            *)
                # Ignore other arguments for compatibility
                shift
                ;;
        esac
    done

    # Process template if specified
    if [ -n "$TEMPLATE" ]; then
        # Split on colon to get source:destination
        SRC="${TEMPLATE%%:*}"
        DST="${TEMPLATE#*:}"

        # Create destination directory if it doesn't exist
        mkdir -p "$(dirname "$DST")"

        # Copy the file
        cp "$SRC" "$DST"

        echo "Skipped dockerize, copied $SRC to $DST"
    fi